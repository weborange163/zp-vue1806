webpackJsonp([8],{Wk6W:function(e,t){},avxo:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("bOdI"),s=a.n(i),l={data:function(){return{radio:"100001",checkOp:[],checkList:[],form:{tel:"",name:"",shortDes:""},rules:{tel:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^[0-9]*$/,message:"手机号只能输入数字",trigger:"blur"},{min:4,max:12,message:"长度在 4 到 12 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:15,message:"长度在 4 到 15 个字符",trigger:"blur"}],shortDes:[{min:1,max:25,message:"长度在 1 到 25 个字符",trigger:"blur"}]},innerMemDia:!1,identityDia:!1,powerDia:!1,loading:!1,per_page:10,total_pages:0,currentPage:1,tableData:[],options:[{value:"0",label:"全部"},{value:"registTime",label:"注册时间"},{value:"loginTime",label:"最后登录时间"}],options1:[{value:"0",label:"全部"},{value:"1",label:"男"},{value:"2",label:"女"}],value:"",value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",userId:""}},created:function(){this.showList()},methods:{showList:function(){var e=this;this.loading=!0;var t=s()({tokenId:this.$store.state.user.tokenId,limit:this.per_page,offset:this.currentPage,status:this.value,simpleParameter:this.value6,queryType:this.value,sex:this.value3,ageStart:this.value4,ageEnd:this.value5},"simpleParameter",this.value6);0==this.value&&(t.queryType="",t.startTime="",t.endTime=""),0==this.value3&&(t.sex=""),this.value2&&(t.startTime=this.value2[0],t.endTime=this.value2[1]),this.$post("members/list",t).then(function(t){if(0==t.code){var a=t.data[0].rows;a.map(function(e){"未填写"==e.province?e.addr="未填写":e.addr=e.province+e.city+e.area}),console.log(a),e.tableData=a,e.total_pages=t.data[0].total,e.loading=!1}})},setIdentity:function(e,t){this.identityDia=!0,console.log(e,t),"认证会员"==t.identity?this.radio="100003":this.radio="100001",this.userId=t.userId},changeIdentity:function(){var e=this,t={tokenId:this.$store.state.user.tokenId,levelCode:this.radio,userId:this.userId};this.$post("members/updateLevel",t).then(function(t){0==t.code&&(e.identityDia=!1,e.userId="",e.showList(),e.$message({message:t.msg,type:"success"}))})},setPower:function(e,t){var a=this;this.powerDia=!0,this.userId=t.userId,this.$post("members/prohibit/findList",{tokenId:this.$store.state.user.tokenId,status:"1"}).then(function(e){a.checkOp=e.data;var i={tokenId:a.$store.state.user.tokenId,userId:t.userId};a.$post("members/getPermissions",i).then(function(e){e.data[0]&&(a.checkList=e.data[0].prohibitCodes.split(","))})})},changePower:function(){var e=this,t={tokenId:this.$store.state.user.tokenId,prohibitCodes:this.checkList.join(","),userId:this.userId};this.$post("members/setPermissions",t).then(function(t){console.log(t),0==t.code?(e.$message({message:t.msg,type:"success"}),e.powerDia=!1):e.$message({message:"设置失败请重试!",type:"error"})})},createInner:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a={tokenId:e.$store.state.user.tokenId,phone:e.form.tel,nickName:e.form.name,userDesc:e.form.shortDes};e.$post("members/addInnerMember",a).then(function(t){0==t.code?(e.innerMemDia=!1,e.$message({message:t.msg,type:"success"}),e.showList()):e.$message({message:"添加失败请重试!",type:"error"})})}})},handleCurrentChange:function(e){this.currentPage=e,this.showList()},handleSizeChange:function(e){this.per_page=e,this.showList()},tofilter:function(e){console.log(e),console.log(this.value)},handleInfo:function(e,t){console.log(e,t)},miniTable:function(e){return"miniTable"}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-body member"},[a("div",{staticClass:"page-header clearfix"},[a("el-row",[a("el-col",{attrs:{span:14}},[a("el-row",{staticStyle:{"margin-bottom":"8px"},attrs:{gutter:6}},[a("el-col",{attrs:{span:7}},[a("el-select",{attrs:{size:"mini",placeholder:"时间类型"},on:{change:e.tofilter},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-date-picker",{attrs:{size:"mini",type:"datetimerange","value-format":"yyyy-MM-dd HH-mm-ss","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","00:00:00"]},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}})],1),e._v(" "),a("el-row",{attrs:{gutter:6}},[a("el-col",{attrs:{span:7}},[a("el-select",{attrs:{size:"mini",placeholder:"性别"},on:{change:e.tofilter},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}},e._l(e.options1,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{size:"mini",type:"number",placeholder:"请输入起始年龄"},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{size:"mini",type:"number",placeholder:"请输入结束年龄"},model:{value:e.value5,callback:function(t){e.value5=t},expression:"value5"}})],1)],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-top":"26px"},attrs:{span:9,offset:0}},[a("el-row",{attrs:{gutter:6,type:"flex",justify:"end"}},[a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{size:"mini",placeholder:"请输入用户名/用户ID/手机号"},model:{value:e.value6,callback:function(t){e.value6=t},expression:"value6"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{staticClass:"light_btn",attrs:{size:"mini"},on:{click:e.showList}},[e._v("搜索")])],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"member_table"},[a("div",{staticClass:"text-right marBo4"},[a("el-button",{staticClass:"light_btn",attrs:{size:"mini"},on:{click:function(t){e.innerMemDia=!0}}},[e._v("创建小号")]),e._v(" "),a("el-button",{staticClass:"light_btn",attrs:{size:"mini"},on:{click:function(t){e.showList()}}},[e._v("刷新")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":e.miniTable,"header-row-class-name":e.miniTable,data:e.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"identity",label:"身份",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"age",width:"50",label:"年龄"}}),e._v(" "),a("el-table-column",{attrs:{prop:"addr",label:"城市",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"注册时间",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userCode",label:"会员ID",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{prop:"loginTime",label:"最后登录时间",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"124"},scopedSlots:e._u([{key:"default",fn:function(t){return["内部小号"!=t.row.identity?a("div",[a("router-link",{attrs:{to:{name:"member-info",params:{id:t.row.userId}}}},[a("el-button",{attrs:{type:"text",size:"mini"}},[e._v("详情")])],1),e._v(" "),a("el-button",{staticClass:"marL10",attrs:{type:"text",size:"mini"},on:{click:function(a){e.setPower(t.$index,t.row)}}},[e._v("权限")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){e.setIdentity(t.$index,t.row)}}},[e._v("身份")])],1):a("div",[a("router-link",{attrs:{to:{name:"member-info",params:{id:t.row.userId}}}},[a("el-button",{attrs:{type:"text",size:"mini"}},[e._v("详情")])],1),e._v(" "),a("el-button",{staticClass:"marL10",attrs:{type:"text",size:"mini",disabled:""}},[e._v("权限")]),e._v(" "),a("el-button",{attrs:{type:"text",disabled:"",size:"mini"}},[e._v("身份")])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"marT20"},[a("el-pagination",{staticClass:"text-right",attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":this.per_page,layout:"total, sizes, prev, pager, next, jumper",total:this.total_pages},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"创建内部小号",visible:e.innerMemDia,width:"30%",center:""},on:{"update:visible":function(t){e.innerMemDia=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"手机号:","label-width":"80px",prop:"tel"}},[a("el-input",{attrs:{"auto-complete":"off",size:"mini",placeholder:"请输入4-12位数字"},model:{value:e.form.tel,callback:function(t){e.$set(e.form,"tel",t)},expression:"form.tel"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名:","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{size:"mini",placeholder:"请输入4-15个字"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"简介:","label-width":"80px",prop:"shortDes"}},[a("el-input",{attrs:{type:"textarea",size:"mini",placeholder:"请输入简介"},model:{value:e.form.shortDes,callback:function(t){e.$set(e.form,"shortDes",t)},expression:"form.shortDes"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.innerMemDia=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.createInner}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"选择会员身份",visible:e.identityDia,width:"30%",center:""},on:{"update:visible":function(t){e.identityDia=t}}},[a("div",{staticClass:"text-center"},[a("el-radio",{attrs:{label:"100001"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("普通会员")]),e._v(" "),a("el-radio",{attrs:{label:"100003"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("认证会员(带V身份标识）")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"light_btn",on:{click:function(t){e.identityDia=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"light_btn",attrs:{type:"primary"},on:{click:e.changeIdentity}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"修改用户权限",visible:e.powerDia,width:"30%",center:""},on:{"update:visible":function(t){e.powerDia=t}}},[a("div",[a("el-checkbox-group",{attrs:{id:"checkList"},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.checkOp,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.prohibitCode}},[e._v(e._s(t.prohibitName))])}))],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"light_btn",on:{click:function(t){e.powerDia=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"light_btn",attrs:{type:"primary"},on:{click:e.changePower}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(l,r,!1,function(e){a("Wk6W")},null,null);t.default=o.exports}});
//# sourceMappingURL=8.f8b6d4d7875b7500b5ae.js.map