webpackJsonp([18],{"6r2Q":function(e,t){},SsAl:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),l=a("rx7x"),n=a("TIfe"),o={data:function(){return{pictureId:"",upData:[],columnName:"",hasChangeFile:!1,fileList:[],isEdit:!1,editId:"",newDialog:!1,imgDialog:!1,dialogImageUrl:"",loading:!1,loading2:!1,baceUrl:"",miniTable:l.miniTable,btnTable:l.btnTable,per_page:10,total_pages:0,currentPage:1,tableData:[],input:"",classForm:{name:"",enabled:"1"},classRules:{name:[{required:!0,message:"请输入标题",trigger:"blur"},{min:2,max:4,message:"长度在 2 到 4 个字",trigger:"blur"}],icon:[]},hasFmt:!1}},created:function(){this.baceUrl=Object(n.a)(),this.getList()},methods:{order:function(e,t,a){var s=this,i={},l="";1==a?(i={tokenId:this.$store.state.user.tokenId,firstId:this.tableData[e-1].id,lastId:t},l="/videoColumn/updateByOrder"):2==a?(i={tokenId:this.$store.state.user.tokenId,firstId:t,lastId:this.tableData[e+1].id},l="/videoColumn/updateByOrder"):3==a?(i={tokenId:this.$store.state.user.tokenId,operType:"0",id:this.tableData[e].id},l="/videoColumn/stickOrBottom"):(i={tokenId:this.$store.state.user.tokenId,operType:"1",id:this.tableData[e].id},l="/videoColumn/stickOrBottom"),console.log(i),this.$post(l,i).then(function(e){console.log(e),0==e.code?(s.$message({type:"success",message:e.msg}),s.getList(s.currentPage)):s.$message({type:"warning",message:e.msg?e.msg:"操作失败"})})},editClass:function(e){this.newDialog=!0,this.hasChangeFile=!1,this.classForm=JSON.parse(i()(e)),e.picture_url&&this.fileList.push({url:e.picture_url}),this.hasFmt=!0,this.editId=e.id,this.pictureId=e.picture_id,this.isEdit=!0},createClass:function(){var e=this;this.$refs.classForm.validate(function(t){if(t){var a=e.$loading({lock:!0,target:document.querySelector(".app-container"),text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s=new FormData;s.append("tokenId",e.$store.state.user.tokenId),s.append("name",e.classForm.name),s.append("enabled",e.classForm.enabled),e.isEdit&&(s.append("id",e.editId),s.append("pictureId",e.pictureId)),e.hasChangeFile?s.append("newsFile",e.classForm.file,e.classForm.filename):s.append("newsFile",""),e.$post("videoColumn/save",s).then(function(t){0==t.code?(e.newDialog=!1,a.close(),e.$refs.upload.clearFiles(),e.$refs.classForm.resetFields(),e.classForm.enabled="1",e.classForm.file="",e.fileList=[],e.$message({type:"success",message:t.msg}),setTimeout(function(){e.getList(e.currentPage)},500)):e.$message({type:"warning",message:t.msg?t.msg:"出错了"})})}})},deleteClass:function(e){var t=this;this.$confirm("此操作将删除该栏目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={tokenId:t.$store.state.user.tokenId,id:e};t.$post("videoColumn/delete",a).then(function(e){console.log(e),0==e.code?(t.$message({type:"success",message:"删除成功!"}),setTimeout(function(){t.getList()},1e3)):"1"==e.code?t.$message({type:"error",message:e.msg}):t.$message({type:"info",message:"删除失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getList:function(e){var t=this;this.currentPage=e||1;var a={tokenId:this.$store.state.user.tokenId,limit:this.per_page,offset:this.currentPage,queryField:this.columnName};this.$get("/videoColumn/list",a).then(function(e){0==e.code&&(t.tableData=e.data[0].rows,t.loading=!1,t.total_pages=e.data[0].total)})},beforeClose:function(){this.newDialog=!1,this.fileList=[],this.$refs.classForm.resetFields(),this.isEdit=!1,this.classForm={title:"",enabled:"1"}},handleCurrentChange:function(e){this.getList(e)},handlePictureCardPreview:function(e){console.log(e),this.dialogImageUrl=e.url,this.imgDialog=!0},fileChange:function(e,t){this.$refs.icon.clearValidate(),this.classForm.filename=e.name,this.hasChangeFile=!0,this.classForm.file=e.raw,console.log(e.raw),t.length>0&&(this.hasFmt=!0)},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件")},handleRemove:function(e,t){this.pictureId="",this.hasChangeFile=!0,0==t.length&&(this.hasFmt=!1,this.classForm.file="",this.classForm.filename="")},handleSizeChange:function(e){this.per_page=e,this.getList()}},computed:{tableLength:function(){return this.tableData.length-1},upDataLength:function(){return this.upData.length-1}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-body rules"},[a("div",{staticClass:"breadcrumb",staticStyle:{padding:"8px"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("系统设置")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/rules-list"}}},[e._v("规则管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("视频栏目管理")])],1)],1),e._v(" "),a("div",{staticClass:"page-header"},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"请输入栏目名称"},model:{value:e.columnName,callback:function(t){e.columnName=t},expression:"columnName"}}),e._v(" "),a("el-button",{staticClass:"light_btn",on:{click:function(t){e.getList()}}},[e._v("搜索")])],1),e._v(" "),a("div",{staticClass:"box",staticStyle:{width:"1000px",margin:"0 auto"}},[a("div",{staticClass:"text-right marBo4"},[a("el-button",{staticClass:"light_btn",attrs:{size:"mini"},on:{click:function(t){e.$router.back()}}},[e._v("返回")]),e._v(" "),a("el-button",{staticClass:"light_btn",attrs:{size:"mini"},on:{click:function(t){e.newDialog=!0,e.classForm.title="",e.classForm.radio="1",e.isEdit=!1,e.hasChangeFile=!0}}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"600"}}),e._v(" 栏目")]),e._v(" "),a("el-button",{staticClass:"light_btn",attrs:{size:"mini"},on:{click:function(t){e.getList()}}},[e._v("刷新")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{},attrs:{"row-class-name":e.miniTable(),"header-row-class-name":e.miniTable(),data:e.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"栏目名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"icon",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.picture_url?a("img",{attrs:{src:t.row.picture_url,alt:""}}):a("p",[e._v("暂无图片")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.enabled?a("p",{staticClass:"yshx"},[e._v("启用")]):e._e(),e._v(" "),"0"==t.row.enabled?a("p",{staticClass:"dshx"},[e._v("关闭")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_time",label:"修改时间",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"260",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.order(t.$index,t.row.id,3)}}},[a("i",{staticClass:"iconfont icon-Gototop"})]),e._v(" "),"0"==t.$index?a("el-button",{attrs:{type:"text",disabled:""}},[a("i",{staticClass:"iconfont icon-up"})]):a("el-button",{attrs:{type:"text"},on:{click:function(a){e.order(t.$index,t.row.id,1)}}},[a("i",{staticClass:"iconfont icon-up"})]),e._v(" "),t.$index!=e.tableLength?a("el-button",{attrs:{type:"text"},on:{click:function(a){e.order(t.$index,t.row.id,2)}}},[a("i",{staticClass:"iconfont icon-down"})]):a("el-button",{attrs:{type:"text",disabled:""}},[a("i",{staticClass:"iconfont icon-down"})]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.order(t.$index,t.row.id,4)}}},[a("i",{staticClass:"iconfont icon-Gotobottom"})]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.editClass(t.row)}}},[a("i",{staticClass:"iconfont icon-edit"})]),e._v(" "),a("el-button",{attrs:{type:"text"}},[a("i",{staticClass:"iconfont icon-delete",on:{click:function(a){e.deleteClass(t.row.id)}}})])]}}])})],1),e._v(" "),a("div",{staticClass:"marT20"},[a("el-pagination",{staticClass:"text-right",attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":this.per_page,layout:"total, sizes, prev, pager, next, jumper",total:this.total_pages},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{center:"","before-close":e.beforeClose,width:"30%","close-on-click-modal":!1,visible:e.newDialog,"append-to-body":""},on:{"update:visible":function(t){e.newDialog=t}}},[a("el-form",{ref:"classForm",staticClass:"classForm",attrs:{model:e.classForm,rules:e.classRules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"栏目标题",prop:"name",size:"mini"}},[a("el-input",{staticStyle:{width:"70%"},model:{value:e.classForm.name,callback:function(t){e.$set(e.classForm,"name",t)},expression:"classForm.name"}})],1),e._v(" "),a("el-form-item",{ref:"icon",attrs:{label:"上传icon","label-width":"110px",prop:"icon"}},[a("el-upload",{ref:"upload",attrs:{action:"",accept:"image/jpeg,image/gif,image/png,image/bmp",multiple:!1,limit:1,name:"file","list-type":"picture-card","file-list":e.fileList,"auto-upload":!1,"on-exceed":e.handleExceed,"on-preview":e.handlePictureCardPreview,"on-change":e.fileChange,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.imgDialog,modal:!1},on:{"update:visible":function(t){e.imgDialog=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),a("el-form-item",{attrs:{label:"使用状态",required:""}},[a("el-radio",{attrs:{label:"1"},model:{value:e.classForm.enabled,callback:function(t){e.$set(e.classForm,"enabled",t)},expression:"classForm.enabled"}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:e.classForm.enabled,callback:function(t){e.$set(e.classForm,"enabled",t)},expression:"classForm.enabled"}},[e._v("关闭")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"light_btn",on:{click:function(t){e.beforeClose()}}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"light_btn",attrs:{type:"primary"},on:{click:e.createClass}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,r,!1,function(e){a("6r2Q")},null,null);t.default=c.exports}});
//# sourceMappingURL=18.58504212204a35b5ec9f.js.map