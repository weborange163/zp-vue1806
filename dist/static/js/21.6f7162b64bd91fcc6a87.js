webpackJsonp([21],{IGic:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("rx7x"),i=n("TIfe"),l={data:function(){return{fileList:[],baceUrl:"",search_info:"",imgFullSrc:"",btnTable:a.btnTable,dialogVisible:!1,loading:!1,upData:[],per_page:2,params:{},total_pages:0,currentPage:1,banner_data:[],bannerDialog:!1,banner1:!1,dialogVisible2:!1,dialogImageUrl:"",uploadData:{},bannerForm:[],bannerForm1:[],bannerRules:{title_short:[{required:!0,message:"请输入短标题",trigger:"blur"}]}}},computed:{upDataLength:function(){return this.upData.length-1}},created:function(){this.baceUrl=Object(i.a)(),this.initParams(),this.getBannerlist()},methods:{toBanner1:function(){var t=this;this.uploadData={tokenId:this.$store.state.user.tokenId,titleShort:this.bannerForm.title_short,bannerType:this.bannerForm.type,linkId:this.bannerForm.link,articleId:this.bannerForm.articleId},setTimeout(function(){t.$refs.upload.submit(),t.$message({type:"success",message:"添加成功!"}),setTimeout(function(){t.getBannerlist()},1e3),t.bannerDialog=!1},0)},top_flag1:function(t,e){var n=this;this.$confirm("确定要下线吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={tokenId:n.$store.state.user.tokenId,id:e.id,status:"2"};n.$post("/bannerInfo/isOnline",t).then(function(t){n.$message({type:"success",message:"下线成功!"}),setTimeout(function(){n.getBannerlist()},1e3),n.banner1=!1})}).catch(function(){n.$message({type:"info",message:"下线失败"})})},top_flag2:function(t,e){var n=this;this.$confirm("确定上线吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={tokenId:n.$store.state.user.tokenId,id:e.id,status:"1"};n.$post("/bannerInfo/isOnline",t).then(function(t){n.$message({type:"success",message:"上线成功!"}),n.getBannerlist1()})}).catch(function(){n.$message({type:"info",message:"上线失败"})})},bannerEdit:function(t,e){var n=this;this.fileList=[],this.bannerDialog=!0;var a={tokenId:this.$store.state.user.tokenId,id:e.id};this.$get("/bannerInfo/show",a).then(function(t){n.bannerForm=t.data[0],n.imgSrc=n.bannerForm.coverImgId,n.imgFullSrc=n.baceUrl+n.imgSrc,n.fileList.push({url:n.imgFullSrc})})},bannerShow:function(t,e){var n=this;this.fileList=[],console.log(t,e);var a={tokenId:this.$store.state.user.tokenId,id:e.id};this.$get("/bannerInfo/show",a).then(function(t){console.log(t.data[0]),n.bannerForm1=t.data[0],n.imgSrc=n.bannerForm1.coverImgId,n.imgFullSrc=n.baceUrl+n.imgSrc,console.log(n.imgFullSrc)})},handleRemove:function(t,e){console.log(t,e)},handlePictureCardPreview:function(t){console.log(t),this.dialogImageUrl=t.url},getFullUrl:function(){return this.baceUrl+"/bannerInfo/save"},publishWaitTop:function(){var t=this;this.dialogVisible=!0,this.loading=!0,this.$get("/bannerInfo/getIsOnline",{tokenId:this.$store.state.user.tokenId}).then(function(e){t.loading=!1,console.log(e),t.upData=e.data})},toPublish:function(){var t=[];this.upData.map(function(e,n){t.push(e.id)});var e={tokenId:this.$store.state.user.tokenId,ids:t.join(",")};console.log(e),this.$post("/industry/publishOrederByIds",e).then(function(t){console.log(t)}),this.dialogVisible=!1},getBannerlist:function(t){var e=this;if(!t)t={tokenId:this.$store.state.user.tokenId,limit:this.per_page,offset:this.currentPage,simpleParameter:this.search_info};console.log(t),this.$post("bannerInfo/list",t).then(function(t){console.log(t.data[0].rows);var n=t.data[0].rows;n.map(function(t){t.imgurl=e.baceUrl+t.cover_img_id}),e.banner_data=n,e.total_pages=t.data[0].total}),this.search_info=""},getBannerlist1:function(t){var e=this;if(!t)t={tokenId:this.$store.state.user.tokenId,limit:this.per_page,offset:this.currentPage};this.$post("bannerInfo/list",t).then(function(t){console.log(t.data[0].rows),e.banner_data=t.data[0].rows,e.total_pages=t.data[0].total}),this.banner1=!1},initParams:function(){this.params={tokenId:this.$store.state.user.tokenId,limit:this.per_page,offset:this.currentPage}},handleCurrentChange:function(t){this.currentPage=t,this.initParams(),console.log(this.params),this.getBannerlist(this.params)},deleteRow:function(t,e){var n=this;this.$confirm("此操作将永久删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={tokenId:n.$store.state.user.tokenId,id:e.id};n.$post("/bannerInfo/delete",t).then(function(t){n.$message({type:"success",message:"删除成功!"}),n.getBannerlist()})}).catch(function(){n.$message({type:"info",message:"已取消删除"})}),console.log(t,e)},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},changeIndex:function(t,e,n){if("isUp"==n){var a=e[t],i=e[t-1];e.splice(t-1,1,a),e.splice(t,1,i)}else{a=e[t],i=e[t+1];e.splice(t+1,1,a),e.splice(t,1,i)}},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},sort:function(){var t=[{id:1},{id:2},{id:3},{id:4},{id:5},{id:6}],e=t[2];t[2]=t[3],t[3]=e,console.log(t)}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-body banner"},[n("el-dialog",{attrs:{center:"",title:"设置置顶内容排序",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.upData,border:"","row-class-name":t.btnTable,"header-row-class-name":t.btnTable}},[n("el-table-column",{attrs:{prop:"titleShort",label:"标题"}}),t._v(" "),n("el-table-column",{staticClass:"text-center",attrs:{prop:"name",label:"操作",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[0!=e.$index?n("el-button",{attrs:{type:"text"},on:{click:function(n){t.changeIndex(e.$index,t.upData,"isUp")}}},[n("i",{staticClass:"iconfont icon-up"})]):n("el-button",{attrs:{type:"text",disabled:""}},[n("i",{staticClass:"iconfont icon-up unclick"})]),t._v(" "),e.$index!=t.upDataLength?n("el-button",{attrs:{type:"text"},on:{click:function(n){t.changeIndex(e.$index,t.upData,"isDown")}}},[n("i",{staticClass:"iconfont icon-down"})]):n("el-button",{attrs:{type:"text",disabled:""}},[n("i",{staticClass:"iconfont icon-down",staticStyle:{cursor:"not-allowed"}})])]}}])})],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.toPublish()}}},[t._v("发 布")])],1)],1),t._v(" "),n("el-dialog",{attrs:{center:"",width:"30%",visible:t.bannerDialog,"append-to-body":""},on:{"update:visible":function(e){t.bannerDialog=e}}},[n("el-form",{ref:"bannerForm",staticClass:"bannerForm",attrs:{data:t.bannerForm,rules:t.bannerRules,"label-width":"110px"}},[n("el-form-item",{attrs:{label:"原文标题"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.bannerForm.titleOriginal,callback:function(e){t.$set(t.bannerForm,"titleOriginal",e)},expression:"bannerForm.titleOriginal"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"短标题",prop:"titleShort"}},[n("el-input",{model:{value:t.bannerForm.titleShort,callback:function(e){t.$set(t.bannerForm,"titleShort",e)},expression:"bannerForm.titleShort"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"banner图片","label-width":"110px",required:""}},[n("el-upload",{ref:"upload",attrs:{action:t.getFullUrl(),data:t.uploadData,multiple:!1,limit:1,name:"file","list-type":"picture-card","auto-upload":!1,"file-list":t.fileList,"on-exceed":t.handleExceed,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[n("i",{staticClass:"el-icon-plus"})]),t._v(" "),n("el-dialog",{attrs:{visible:t.dialogVisible2},on:{"update:visible":function(e){t.dialogVisible2=e}}},[n("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),n("el-form-item",{attrs:{label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==t.bannerForm.bannerType?n("el-input",{attrs:{value:"新闻",disabled:""}}):t._e(),t._v(" "),"2"==t.bannerForm.bannerType?n("el-input",{attrs:{value:"专题",disabled:""}}):t._e()]}}])}),t._v(" "),n("el-form-item",{attrs:{label:"链接"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.bannerForm.linkId,callback:function(e){t.$set(t.bannerForm,"linkId",e)},expression:"bannerForm.linkId"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"light_btn",on:{click:function(e){t.bannerDialog=!1,t.recommendRadio=""}}},[t._v("取 消")]),t._v(" "),n("el-button",{staticClass:"light_btn",attrs:{type:"primary"},nativeOn:{click:function(e){e.preventDefault(),t.toBanner1()}}},[t._v("保 存")])],1)],1),t._v(" "),n("el-dialog",{staticStyle:{"z-index":"99999"},attrs:{center:"",width:"30%",visible:t.banner1,"append-to-body":""},on:{"update:visible":function(e){t.banner1=e}}},[n("el-form",{ref:"bannerForm1",staticClass:"bannerForm",attrs:{data:t.bannerForm1,rules:t.bannerRules,"label-width":"110px"}},[n("el-form-item",{attrs:{label:"原文标题"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.bannerForm1.titleOriginal,callback:function(e){t.$set(t.bannerForm1,"titleOriginal",e)},expression:"bannerForm1.titleOriginal"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"短标题",prop:"titleShort"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.bannerForm1.titleShort,callback:function(e){t.$set(t.bannerForm1,"titleShort",e)},expression:"bannerForm1.titleShort"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"banner图片"}},[n("img",{staticClass:"imgs",attrs:{src:t.imgFullSrc,alt:"封面图展示"}})]),t._v(" "),n("el-form-item",{attrs:{label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==t.bannerForm1.bannerType?n("el-input",{attrs:{value:"新闻",disabled:""}}):t._e(),t._v(" "),"2"==t.bannerForm1.bannerType?n("el-input",{attrs:{value:"专题",disabled:""}}):t._e()]}}])}),t._v(" "),n("el-form-item",{attrs:{label:"链接"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.bannerForm1.linkId,callback:function(e){t.$set(t.bannerForm1,"linkId",e)},expression:"bannerForm1.linkId"}})],1)],1)],1),t._v(" "),n("div",{staticClass:"page-header clearfix"},[n("el-input",{staticStyle:{width:"220px",margin:"0 20px"},attrs:{placeholder:"请输入内容"},model:{value:t.search_info,callback:function(e){t.search_info=e},expression:"search_info"}}),t._v(" "),n("el-button",{staticClass:"light_btn",nativeOn:{click:function(e){e.preventDefault(),t.getBannerlist()}}},[t._v("搜索")])],1),t._v(" "),n("div",{staticClass:"box"},[n("div",{staticStyle:{"text-align":"right","margin-bottom":"4px"}},[n("el-button",{staticClass:"light_btn",on:{click:function(e){t.publishWaitTop()}}},[t._v("发布")]),t._v(" "),n("el-button",{staticClass:"light_btn",nativeOn:{click:function(e){e.preventDefault(),t.getBannerlist1()}}},[t._v("刷新")])],1),t._v(" "),n("div",{staticClass:"banner_show"},[n("el-table",{attrs:{data:t.banner_data,border:"",stripe:"","row-class-name":t.btnTable,"header-row-class-name":t.btnTable}},[n("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),t._v(" "),n("el-table-column",{attrs:{label:"原文标题"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.banner_type?n("p",[t._v(t._s(e.row.title_original))]):t._e(),t._v(" "),"2"==e.row.banner_type?n("p",[t._v(t._s(e.row.title_original1))]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"短标语",prop:"title_short"}}),t._v(" "),n("el-table-column",{attrs:{label:"发布状态",prop:"status",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.status?n("p",{staticClass:"yshx"},[t._v("已上线")]):t._e(),t._v(" "),"0"==e.row.status?n("p",{staticClass:"dshx"},[t._v("待上线")]):t._e(),t._v(" "),"2"==e.row.status?n("p",{staticClass:"yxx"},[t._v("已下线")]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"内容类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.banner_type?n("p",[t._v("新闻")]):t._e(),t._v(" "),"2"==e.row.banner_type?n("p",[t._v("专题")]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"图片",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{attrs:{src:t.row.imgurl,alt:""}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"上线时间",prop:"online_time",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"创建时间",prop:"create_time",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"260",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.status&&"1"==e.row.top_flag?n("el-button",{staticStyle:{"margin-right":"8px","vertical-align":"middle"},attrs:{type:"text"},nativeOn:{click:function(n){n.preventDefault(),t.top_flag1(e.$index,e.row)}}},[t._v("下线")]):t._e(),t._v(" "),"1"==e.row.status&&"1"!=e.row.top_flag?n("el-button",{staticStyle:{"margin-right":"8px","vertical-align":"middle"},attrs:{type:"text"},nativeOn:{click:function(n){n.preventDefault(),t.top_flag1(e.$index,e.row)}}},[t._v("下线")]):t._e(),t._v(" "),"2"==e.row.status||"0"==e.row.status?n("el-button",{staticStyle:{"margin-right":"8px","vertical-align":"middle"},attrs:{type:"text"},nativeOn:{click:function(n){n.preventDefault(),t.top_flag2(e.$index,e.row)}}},[t._v("上线")]):t._e(),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){t.bannerShow(e.$index,e.row)}}},[n("i",{staticClass:"iconfont icon-see"})]),t._v(" "),"1"==e.row.status?n("el-button",{attrs:{type:"text",disabled:!0}},[n("i",{staticClass:"iconfont icon-edit"})]):t._e(),t._v(" "),"2"==e.row.status||"0"==e.row.status?n("el-button",{attrs:{type:"text"},nativeOn:{click:function(n){n.preventDefault(),t.bannerEdit(e.$index,e.row)}}},[n("i",{staticClass:"iconfont icon-edit"})]):t._e(),t._v(" "),"1"==e.row.status?n("el-button",{attrs:{type:"text",disabled:!0},nativeOn:{click:function(n){n.preventDefault(),t.deleteRow(e.$index,e.row)}}},[n("i",{staticClass:"iconfont icon-delete"})]):t._e(),t._v(" "),"2"==e.row.status||"0"==e.row.status?n("el-button",{attrs:{type:"text"},nativeOn:{click:function(n){n.preventDefault(),t.deleteRow(e.$index,e.row)}}},[n("i",{staticClass:"iconfont icon-delete"})]):t._e()]}}])})],1),t._v(" "),n("div",{staticStyle:{"margin-top":"20px"}},[n("el-pagination",{staticClass:"text-right",attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":this.per_page,layout:"prev, pager, next",total:this.total_pages},on:{"current-change":t.handleCurrentChange}})],1)],1)])],1)},staticRenderFns:[]};var o=n("VU/8")(l,s,!1,function(t){n("IgrO")},null,null);e.default=o.exports},IgrO:function(t,e){}});
//# sourceMappingURL=21.6f7162b64bd91fcc6a87.js.map