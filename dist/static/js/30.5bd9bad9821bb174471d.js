webpackJsonp([30],{gsBi:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,s=l("bOdI"),i=l.n(s),r=l("RRt9"),o=l("TIfe"),n={data:function(){var t=this;return{hasFmt:!0,accounts:[],dialogVisible:!1,bannerDialog:!1,quill:{width:420,border:!0,height:150,zIndex:101,content:"",syncOutput:!0,theme:"snow",disabled:!1,full:!1,toolbar:[["bold","italic","underline","strike","link",{header:[1,2,3,4,5,6,!1]}],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{align:[!1,"right","center","justify"]}],["image","video"]]},baceUrl:"",fileList:[],editorOption:{},dialogImageUrl:"",classifyTypes:"行情",classifyTypeAll:"",form2:{title:"",content:"",column:"行情",sourceType:"1",source:"",status:"",author:"",userId:"",imgType:"1",showUrl:"",newsFile:"",tagLabel:"",keyWords:"",coverImgId:""},rules2:{title:[{required:!0,validator:r.a.checkTitle,trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"change"},{pattern:/[0-9\u4e00-\u9fa5]+/g,message:"内容必须有中文或者数字",trigger:"blur"}],userId:[{required:!0,message:"请选择发布账号",trigger:"change"}],imgType:[{required:!0,message:"请选择图片",trigger:"change"}],icon:[{required:!0,validator:function(e,l,a){t.hasFmt?a():a(new Error("请上传封面图"))},trigger:"change"}],classifyType:[{required:!0,message:"请选择所属分类",trigger:"blur"}],tagLabel:[{validator:function(t,e,l){""===e?l():e.replace(/，/gi,",").split(",").map(function(t){t.replace(/[^\x00-\xff]/g,"aa").length>12?l(new Error("单个tag标签不能超过12字节!")):l()})},trigger:"blur"}]},uploadData:{},value:"",imgFullSrc:""}},created:function(){this.baceUrl=Object(o.a)()},mounted:function(){var t=this;this.$post("members/findByLevel",{tokenId:this.$store.state.user.tokenId,levelCode:100002}).then(function(e){t.accounts=e.data}),this.$get("/industryCategory/findIndustryCategoryList",{tokenId:this.$store.state.user.tokenId}).then(function(e){t.classifyTypeAll=e.data}),this.$get("/industry/get",{tokenId:this.$store.state.user.tokenId,id:this.$route.params.id}).then(function(e){console.log(e.data[0].industry),t.form2=e.data[0].industry,t.status=t.form2.status,t.classifyType=t.form2.classifyType,t.fileList.push({url:t.form2.showUrl});t.classifyType})},methods:(a={radioChange:function(t){console.log(t),"2"==t?this.hasFmt=!0:this.fileList||(this.hasFmt=!1)},uploadImg:function(t,e){var l=new FormData;l.append("file",t,t.name),this.$post("images/upload",l).then(function(t){var l=t.data[0].showUrl;e(l,"center")})},saveAudit:function(t,e){var l=this;return this.$refs[t].validate(function(t){if(console.log(t),!t)return console.log("error submit!!"),!1;if(2==l.form2.imgType){if(!l.form2.content.match(/src=/gi))return void l.$message.error("内容里没有图片!")}var a=new FormData;a.append("tokenId",l.$store.state.user.tokenId),a.append("title",l.form2.title),a.append("content",l.form2.content),a.append("userId",l.form2.userId),a.append("imgType",l.form2.imgType),a.append("tagLabel",l.form2.tagLabel.replace(/，/gi,",")),a.append("publishSource","1"),a.append("status",e),a.append("classifyType",l.form2.classifyType),a.append("newsFile",l.form2.file,l.form2.filename),a.append("id",l.$route.params.id),l.$post("industry/save",a).then(function(t){0==t.code&&(l.$message({message:t.msg,type:"success"}),setTimeout(function(){l.$router.push({name:"market"})},1e3))})}),!0},onEditorBlur:function(t){t.quill,t.html,t.text},fileOver:function(){this.$message("只允许添加一张图片,如果替换请删除后再上传")}},i()(a,"onEditorBlur",function(t){console.log("editor blur!",t),console.log(this.form2.content)}),i()(a,"onEditorFocus",function(t){console.log("editor focus!",t)}),i()(a,"onEditorReady",function(t){console.log("editor ready!",t)}),i()(a,"onEditorChange",function(t){var e=t.val;console.log("editor change!",e)}),i()(a,"handleRemove",function(t,e){this.hasFmt=!1,console.log(t,e)}),i()(a,"fileChange",function(t,e){this.$refs.icon.clearValidate(),this.form2.filename=t.name,this.form2.file=t.raw,e.length>0&&(this.hasFmt=!0)}),i()(a,"handlePictureCardPreview",function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0,console.log(this.dialogImageUrl),alert("放大")}),i()(a,"fanhui",function(){var t=this;this.$confirm("返回编辑内容将重置是否继续？").then(function(e){t.$router.back(),done()}).catch(function(t){})}),a),watch:{$route:"getParams"}},c={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"page-body market_edit",staticStyle:{"min-width":"980px"}},[l("el-dialog",{attrs:{center:"",width:"22%",visible:t.bannerDialog,"append-to-body":""},on:{"update:visible":function(e){t.bannerDialog=e}}},[l("el-form",{ref:"form2",staticClass:"form2",attrs:{data:t.form2,"label-width":"110px"}},[l("p",{attrs:{id:"p1"},domProps:{innerHTML:t._s(t.form2.title)}}),t._v(" "),l("p",{attrs:{id:"p2"},domProps:{innerHTML:t._s(t.form2.content)}})])],1),t._v(" "),l("div",{staticClass:"breadcrumb",staticStyle:{padding:"8px"}},[l("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[l("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("内容中心")]),t._v(" "),l("el-breadcrumb-item",[t._v("行业信息")]),t._v(" "),l("el-breadcrumb-item",[t._v("添加行情")])],1)],1),t._v(" "),l("div",{staticClass:"box"},[l("div",{staticClass:"text-right"},[l("el-button",{staticClass:"light_btn",attrs:{size:"small"},on:{click:t.fanhui}},[t._v("返回")]),t._v(" "),l("el-button",{staticClass:"light_btn",attrs:{size:"small"},on:{click:function(e){t.bannerDialog=!0}}},[t._v("预览")]),t._v(" "),l("el-button",{staticClass:"light_btn",attrs:{size:"small"},on:{click:function(e){t.saveAudit("form2","1")}}},[t._v("仅保存")]),t._v(" "),l("el-button",{staticClass:"light_btn",attrs:{size:"small"},on:{click:function(e){t.saveAudit("form2",2)}}},[t._v("保存并提交审核")])],1),t._v(" "),l("el-form",{ref:"form2",staticClass:"up_form clearfix",attrs:{model:t.form2,rules:t.rules2,"label-width":"84px"}},[l("div",{staticStyle:{width:"48%",float:"left",padding:"15px","margin-left":"2%","margin-right":"5%"}},[l("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[l("el-input",{staticStyle:{width:"420px"},attrs:{type:"textarea",autosize:"",placeholder:"请输入标题"},model:{value:t.form2.title,callback:function(e){t.$set(t.form2,"title",e)},expression:"form2.title"}})],1),t._v(" "),l("el-form-item",{staticClass:"editor",attrs:{label:"文章内容",prop:"content"}},[l("m-quill-editor",{ref:"myQuillEditor",attrs:{width:t.quill.width,getContent:t.onEditorChange,"has-border":t.quill.border,zIndex:t.quill.zIndex,"sync-output":t.quill.syncOutput,toolbar:t.quill.toolbar,theme:t.quill.theme,disabled:t.quill.disabled,fullscreen:t.quill.full},on:{upload:t.uploadImg,blur:function(e){t.onEditorBlur(e)}},model:{value:t.form2.content,callback:function(e){t.$set(t.form2,"content",e)},expression:"form2.content"}})],1)],1),t._v(" "),l("div",{staticStyle:{width:"35%",float:"left",padding:"15px","min-width":"420px"}},[l("el-form-item",{attrs:{label:"发布到:",required:""}},[l("el-input",{staticStyle:{width:"173px"},attrs:{disabled:!0},model:{value:t.classifyTypes,callback:function(e){t.classifyTypes=e},expression:"classifyTypes"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"所属分类",prop:"classifyType"}},[l("el-select",{staticStyle:{"padding-left":"6px"},attrs:{name:"classifyType",placeholder:"请选择"},model:{value:t.form2.classifyType,callback:function(e){t.$set(t.form2,"classifyType",e)},expression:"form2.classifyType"}},t._l(t.classifyTypeAll,function(t){return l("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),l("el-form-item",{attrs:{label:"发布账号:",prop:"userId"}},[l("el-select",{attrs:{placeholder:"请选择发布账号"},model:{value:t.form2.userId,callback:function(e){t.$set(t.form2,"userId",e)},expression:"form2.userId"}},t._l(t.accounts,function(t){return l("el-option",{key:t.userId,attrs:{label:t.nickName,value:t.userId}})}))],1),t._v(" "),l("el-form-item",{attrs:{label:"附加选项:",prop:"imgType"}},[l("el-radio-group",{on:{change:t.radioChange},model:{value:t.form2.imgType,callback:function(e){t.$set(t.form2,"imgType",e)},expression:"form2.imgType"}},[l("el-radio",{attrs:{label:"1"}},[t._v("上传缩略图")]),t._v(" "),l("el-radio",{attrs:{label:"2"}},[t._v("提取第一个图为缩略图")])],1)],1),t._v(" "),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"1"==t.form2.imgType,expression:"form2.imgType == '1'"}],ref:"icon",attrs:{label:"封面图:",prop:"icon"}},[l("el-upload",{ref:"upload",attrs:{action:"",multiple:!1,limit:1,name:"newsFile","file-list":t.fileList,"list-type":"picture-card","auto-upload":!1,"on-change":t.fileChange,"on-exceed":t.fileOver,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[l("i",{staticClass:"el-icon-plus"})]),t._v(" "),l("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[l("img",{attrs:{width:"100%",src:t.form2.showUrl,alt:""}})])],1),t._v(" "),l("el-form-item",{attrs:{label:"Tag标签:",prop:"tagLabel"}},[l("el-input",{attrs:{placeholder:"用逗号隔开，单个标签少于12字节"},model:{value:t.form2.tagLabel,callback:function(e){t.$set(t.form2,"tagLabel",e)},expression:"form2.tagLabel"}})],1),t._v(" "),l("div",{staticClass:"tableOverstyle"},[l("table",{staticClass:"el-table el-table__body el-table--border",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[l("colgroup",[l("col",{attrs:{name:"el-table_1_column_1",width:"25%"}}),t._v(" "),l("col",{attrs:{name:"el-table_1_column_2",width:"75%"}})]),t._v(" "),l("tbody",[l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("发布来源")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},["1"==t.form2.publishSource?l("span",[t._v("PC后台")]):t._e(),"2"==t.form2.publishSource?l("span",[t._v("数据爬取")]):t._e(),"3"==t.form2.publishSource?l("span",[t._v("APP端")]):t._e()])])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("文章ID")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.articleId))])])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("状态")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},["1"==t.form2.status?l("span",[t._v("新建")]):t._e(),"2"==t.form2.status?l("span",[t._v("待审核")]):t._e(),"4"==t.form2.status?l("span",[t._v("审核不通过")]):t._e(),t._v(" "),"5"==t.form2.status?l("span",[t._v("已上线")]):t._e(),"6"==t.form2.status?l("span",[t._v("已下线")]):t._e()])])])])]),t._v(" "),l("table",{staticClass:"el-table el-table__body el-table--border marT20",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[l("colgroup",[l("col",{attrs:{name:"el-table_1_column_1"}}),t._v(" "),l("col",{attrs:{name:"el-table_1_column_1"}}),t._v(" "),l("col",{attrs:{name:"el-table_1_column_1"}}),t._v(" "),l("col",{attrs:{name:"el-table_1_column_2"}})]),t._v(" "),l("tbody",[l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"})]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v("时间")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v("操作账号")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v("备注")])])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("创建时间")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.createTime))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.createUser))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"})])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("上线时间")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.onlineTime))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.onlineUser))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"})])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("下线时间")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.offlineTime))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.offlineUser))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"})])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("修改时间")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.updateTime))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.updateUser))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"})])]),t._v(" "),l("tr",{staticClass:"el-table__row"},[l("td",[l("div",{staticClass:"cell"},[t._v("审核时间")])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.checkTime))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.checkPerson))])]),t._v(" "),l("td",[l("div",{staticClass:"cell"},[t._v(t._s(t.form2.checkMessage))])])])])])])],1)])],1)],1)},staticRenderFns:[]};var d=l("VU/8")(n,c,!1,function(t){l("ymKz")},null,null);e.default=d.exports},ymKz:function(t,e){}});
//# sourceMappingURL=30.5bd9bad9821bb174471d.js.map